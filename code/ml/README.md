# Machine Learning

## Business Goals
1. Regression: Estimate the expected score (number of up-votes minus the number of down-votes) of a submission using provided and engineered features.
2. Classification: Predict the controversiality of a comment using provided and engineered features.
3. Clustering: Determine what subreddit a submission belongs to based on word embeddings of the submission body and other features.

## Technical Proposal
1. Each submission (and comment) receives a score derived from the number of up-votes minus the number of down-votes as voted by subreddit readers. These scores drive engagement as more popular posts are pushed to the top by Redditâ€™s algorithm. Given this, we will create supervised learning models, specifically Linear Regression and Random Forest Regressor, to predict the score of a submission based on provided features, such as whether a submission has adult content and the `subreddit` the submission belongs to, and engineered features, such as submission `title_length`, `day`, `month`, and `year`, to name a few. We are not concerned with comments for this business goal since we aim to analyze the initial impact and reception of a post on the platform. A score prediction model could help Reddit users improve their posts by predicting their potential engagement. This would enable authors to edit their posts before publishing to maximize visibility and interaction.
2. Unlike submissions, the `controversiality` feature in comments is determined based on both interactions, specifically the number of up-votes minus the number of down-votes, and the balance of these interactions. We will create supervised learning models, specifically  Random Forest Classifier, Logistic Regression, and Gradient Boosting Classifier, to predict the `controversiality` of a comment based on provided features, the score of the comment, the `subreddit` the comment belongs to, whether the comment is `distinguished` (the moderators or admins comment) or `gilded` (number of times the comment received Reddit gold), and engineered features, including `day`, `month`, and `year`. This analysis aids in understanding the dynamics of comment engagement and controversy, offering Reddit a powerful tool for content moderation and user engagement strategies.
3. Using the `Word2Vec` function, we create word embeddings of the `cleaned_body` column, which is the `selftext` column with stopwords removed and lemmatized. We then create a `VectorAssembler` to combine the word embeddings with other provided and engineered columns, including `day`, `month`, `year`, `distinguished`, `score`, `gilded`, `num_comments`, `score`, `over_18`, `is_spoiler`, and `is_video` columns. We then perform PCA on the combined features and condense the features into 2 principal components, facilitating visualization. Then, using the elbow method to obtain `k`, the number of clusters, we create a `KMeans` model and fit the data to obtain the clusters. Better than the elbow method is the silhouette score, which measures how similar an object is to its cluster compared to other clusters. We then use the silhouette score to determine the optimal number of clusters, a hyperparameter-tuning excercise. Finally, we create a `KMeans` model with the optimal number of clusters and fit the data to obtain the clusters. This analysis is valuable for Reddit and its users as it systematically segments submissions into clusters based on their content. We capture the semantic meaning of submission bodies by leveraging word embeddings created with the `Word2Vec` function. Including various features, such as temporal information, user distinctions, scores, and content characteristics, enriches the clustering process, offering a nuanced understanding of subreddit categorization.


